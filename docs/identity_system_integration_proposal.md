# SponLink 身份系統整合方案

## 一、當前身份系統現狀分析

### 1.1 現有身份類型

系統目前支持三種主要用戶角色：
- **贊助商 (Sponsor)**：可以瀏覽活動、購買贊助方案、安排與組織者的會議
- **組織者 (Organizer)**：可以創建和管理活動、設置贊助方案、與贊助商會面
- **管理員 (Admin)**：系統管理人員，擁有全部權限

### 1.2 各身份特有功能

#### 贊助商 (Sponsor) 功能：
- 儀表盤統計（總贊助數、總投資金額、會議數）
- 我的贊助管理
- 購物車功能
- 會議預約和管理

#### 組織者 (Organizer) 功能：
- 儀表盤統計（總活動數、即將到來的會議、贊助商數量）
- 活動創建與管理
- 會議確認與管理

#### 管理員 (Admin) 功能：
- 用戶管理
- 活動審核
- 系統配置
- 數據分析與報表

### 1.3 現有問題

1. **雙重身份衝突**：公司可能同時是贊助商又是組織者，但系統目前以單一身份模式運作
2. **界面分散**：相似功能（如會議管理）在不同身份下分散在不同頁面
3. **上下文切換困難**：無法在保持同一會話的情況下切換身份視角
4. **缺乏統一視圖**：需要登出並使用不同賬號查看不同身份的數據和功能
5. **無企業多用戶支持**：目前身份系統基於個人用戶設計，缺乏對企業多用戶協作的支持

## 二、整合方案建議

### 2.1 使用情境簡化設計

我們將平台體驗簡化為三個基本情境：

1. **未登入使用**：任何人都可訪問的基本功能
2. **登入後使用**：需要用戶認證的個人化功能
3. **角色特定使用**：主辦方、贊助商或管理員的專業功能

這種設計確保：
- 新用戶可以無障礙探索平台
- 個人用戶獲得個性化體驗
- 專業用戶能夠根據需要切換角色

### 2.2 統一身份與權限模型

#### 簡化用戶模型
```typescript
// 用戶角色
enum UserRole {
  ORGANIZER = 'organizer',  // 主辦方
  SPONSOR = 'sponsor',      // 贊助商
  ADMIN = 'admin'           // 系統管理員
}

// 用戶模型
interface User {
  id: string;
  email: string;
  roles: UserRole[];        // 用戶可用角色列表
  activeRole?: UserRole;    // 當前選擇的角色
  organizations?: string[]; // 用戶所屬組織ID列表 (支持企業多用戶)
  currentOrganization?: string; // 當前選擇的組織ID
}
```

#### 功能訪問控制
```typescript
// 功能類型
enum FeatureType {
  PUBLIC,         // 公開功能（未登入可用）
  AUTHENTICATED,  // 認證功能（需登入）
  ROLE_SPECIFIC   // 角色特定功能（需特定角色）
}

// 功能訪問檢查
function canAccessFeature(feature: Feature, user?: User): boolean {
  // 公開功能任何人都能訪問
  if (feature.type === FeatureType.PUBLIC) {
    return true;
  }
  
  // 需要登入的功能
  if (feature.type === FeatureType.AUTHENTICATED) {
    return !!user;
  }
  
  // 角色特定功能
  if (feature.type === FeatureType.ROLE_SPECIFIC) {
    if (!user) return false;
    
    // 檢查用戶是否擁有所需角色
    return user.roles.includes(feature.requiredRole);
  }
  
  return false;
}
```

### 2.3 無縫角色切換機制

#### 技術實現
```typescript
// 執行需要特定角色的操作
function performRoleAction(action: Action, role: UserRole, user: User) {
  // 確保用戶已登入
  if (!user) {
    return promptLogin(() => {
      // 登入後檢查角色並執行
      checkRoleAndExecute(action, role);
    });
  }
  
  // 確保用戶有所需角色
  if (!user.roles.includes(role)) {
    return promptRoleActivation(role, () => {
      // 激活角色後執行
      executeAction(action, role);
    });
  }
  
  // 自動切換到所需角色
  if (user.activeRole !== role) {
    user.activeRole = role;
    // 提供輕量提示：已切換角色
    showRoleSwitchIndicator(role);
  }
  
  // 執行操作
  return executeAction(action, role);
}
```

#### 用戶體驗設計
- 角色切換時保持用戶當前上下文和位置
- 提供輕量級視覺提示指示當前角色
- 切換不中斷用戶操作流程

## 三、使用情境詳細設計

### 3.1 未登入使用

**可用功能**：
- 活動瀏覽與搜索
- 活動篩選與排序
- 基本活動詳情查看
- 活動比較（本地暫存）
- 公開信息查詢

**設計原則**：
- 無障礙探索體驗
- 引導但不強制登入
- 功能入口保持可見，點擊受限功能時提示登入

### 3.2 登入後使用

**增加的功能**：
- 個人收藏與偏好設置
- 歷史記錄保存
- 查看更詳細的活動和贊助信息
- 個人資料管理
- 比較列表持久化

**設計原則**：
- 保持與未登入體驗的一致性
- 提供個人化功能
- 數據跨設備同步

### 3.3 角色特定使用

#### 主辦方角色
**專屬功能**：
- 活動創建與管理
- 贊助方案設置
- 活動數據分析
- 會議管理（主辦方視角）

#### 贊助商角色
**專屬功能**：
- 贊助方案查看與購買
- 贊助管理
- 贊助效果分析
- 會議管理（贊助商視角）

#### 管理員角色
**專屬功能**：
- 用戶管理與權限設置
- 活動審核與管理
- 系統參數配置
- 全平台數據報表
- 內容審核工具

**設計原則**：
- 基於操作自動切換角色
- 角色切換不中斷用戶任務
- 保持界面結構一致性，僅調整功能可用性

## 四、企業/團隊多用戶支持

### 4.1 企業用戶模型

為支持企業多用戶協作場景，擴展系統模型：

```typescript
// 企業/團隊模型
interface Organization {
  id: string;
  name: string;
  logo?: string;
  description?: string;
  roles: OrganizationRole[];  // 組織可擁有的角色
}

// 組織角色
interface OrganizationRole {
  id: string;
  name: string;  // 例如：管理員、編輯者、查看者
  permissions: string[];  // 組織內部權限
}

// 組織成員
interface OrganizationMember {
  userId: string;
  organizationId: string;
  roleId: string;  // 指向OrganizationRole
  joinedAt: string;
}

// 擴展用戶模型
interface User {
  // ...現有屬性
  organizations: {
    organizationId: string;
    roles: string[];  // 組織內部角色ID列表
  }[];
  currentOrganizationId?: string;  // 當前選擇的組織
}
```

### 4.2 企業用戶功能

#### 組織管理
- 創建和管理組織資料
- 邀請和管理成員
- 設置成員角色和權限
- 組織資源管理

#### 組織資源共享
- 共享活動管理
- 團隊贊助管理
- 共享會議安排
- 組織級數據分析

#### 協作功能
- 活動協作編輯
- 贊助決策流程
- 任務分配與跟蹤
- 組織內通知

### 4.3 企業用戶體驗流程

#### 組織身份切換
```
+--------------------------------------------------+
|  SponLink            [個人 ▼]          [用戶名 ▼] |
|                     ┌─────────┐                   |
|                     │ 個人    │                   |
|                     │ ABC公司 │                   |
|                     │ XYZ機構 │                   |
|                     └─────────┘                   |
+--------------------------------------------------+
```

當用戶切換到組織身份時：
- 可見的資源和功能根據組織權限調整
- 操作將影響組織資源而非個人資源
- 顯示當前組織情境的視覺指示

#### 企業用戶角色協作
```
1. 企業管理員創建活動草稿
2. 分配編輯權限給特定成員
3. 團隊成員協作完善活動詳情
4. 管理員審核並發布活動
5. 贊助請求由財務角色成員審批
```

### 4.4 企業用戶界面設計

- **組織切換器**：在頂部導航提供組織切換功能
- **組織儀表盤**：展示組織活動、贊助和會議概覽
- **團隊協作區**：顯示任務、通知和動態
- **權限指示**：視覺化展示當前用戶在組織中的權限

## 五、統一界面設計方案

### 5.1 統一導航結構

- 單一導航系統服務所有用戶
- 根據用戶狀態、角色和組織身份調整操作可用性
- 未登入用戶點擊受限功能時提示登入

### 5.2 角色與組織身份指示

- 當用戶擁有多角色和多組織時，提供清晰的身份切換機制
- 當前角色和組織視覺指示清晰但不突兀
- 身份切換僅影響操作選項，不改變整體界面結構

### 5.3 情境化操作元素

- 同一界面元素根據用戶狀態、角色和組織身份顯示不同操作
- 例如，活動卡片：
  - 未登入用戶：基本查看選項
  - 登入用戶：增加收藏選項
  - 主辦方：增加管理選項
  - 贊助商：增加贊助選項
  - 組織成員：根據組織權限顯示相應操作

## 六、典型用戶場景

### 6.1 未登入探索到贊助

```
1. 未登入用戶瀏覽活動列表
2. 查看感興趣的活動詳情
3. 點擊「查看贊助方案」
4. 系統提示需要登入
5. 用戶完成登入
6. 查看詳細贊助方案
7. 點擊「贊助此活動」
8. 系統自動切換到贊助商角色
9. 用戶完成贊助流程
```

### 6.2 主辦方轉換為贊助商

```
1. 用戶以主辦方身份管理活動
2. 瀏覽其他活動時，發現感興趣的贊助機會
3. 點擊「贊助此活動」
4. 系統自動從主辦方切換到贊助商角色
5. 用戶完成贊助操作
6. 可通過角色指示器切換回主辦方角色
7. 繼續管理自己的活動
```

### 6.3 企業多用戶協作

```
1. 企業管理員登入並切換到組織身份
2. 創建活動草稿並邀請團隊成員協作
3. 團隊成員登入，收到協作邀請
4. 切換到組織身份查看草稿
5. 多位成員協同編輯活動詳情
6. 管理員審核並發布
7. 其他組織看到活動，通過組織身份進行贊助
```

## 七、實施建議

### 7.1 技術實現重點

1. **統一的用戶與組織模型**
   - 支持多角色屬性
   - 實現組織和個人身份分離
   - 維護當前活動角色和組織狀態

2. **情境化UI組件**
   - 組件根據用戶狀態、角色和組織身份自適應
   - 使用React Context或狀態管理庫提供角色和組織信息

3. **無縫認證與身份切換流程**
   - 登入提示保留當前操作上下文
   - 角色和組織身份切換不中斷用戶體驗

4. **權限管理系統**
   - 支持個人權限和組織權限共存
   - 實現組織內部細粒度權限控制

### 7.2 實施優先級

1. **核心身份系統改造**
   - 實現多角色支持
   - 開發角色轉換機制

2. **基礎功能分層**
   - 明確劃分公開/認證/角色特定功能
   - 實現統一的訪問控制

3. **企業多用戶支持**
   - 實現組織模型和權限系統
   - 開發組織切換機制

4. **協作功能開發**
   - 實現資源共享和協作編輯
   - 開發組織內通知系統

## 八、結論與建議

1. **簡化模型的優勢**
   - 降低學習曲線
   - 保持界面一致性
   - 提高開發效率

2. **無縫體驗的重要性**
   - 減少用戶操作中斷
   - 增強平台粘性
   - 鼓勵角色轉換和探索

3. **企業協作的商業價值**
   - 支持更複雜的B2B場景
   - 提供企業版訂閱潛力
   - 增強平台競爭力

4. **實施建議**
   - 採用漸進式實施策略
   - 優先解決雙重身份問題
   - 以用戶任務為中心設計界面
   - 為企業用戶需求預留擴展性

通過這種設計，SponLink平台可以為個人和企業用戶提供直觀、連貫的體驗，讓他們能夠輕鬆地在不同角色和組織身份間切換，同時保持操作上下文和數據連續性。這種方案既滿足了當前的需求，又為未來的企業級功能擴展奠定了基礎。 