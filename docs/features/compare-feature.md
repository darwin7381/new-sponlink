# 贊助方案比較功能

## 功能概述

贊助方案比較功能允許贊助商在做出決策前對多個活動的贊助方案進行詳細比較。該功能設計為與購物車系統無縫集成，可以提高用戶體驗並增加贊助商對方案選擇的信心。

## 核心組件

### 1. 比較頁面 (`/compare`)

比較頁面以表格形式展示所有添加到比較列表的贊助方案，允許用戶並排比較各個方案的詳細信息。

- **路徑**: `/compare`
- **文件**: `src/app/compare/page.tsx`
- **功能**:
  - 從 localStorage 加載比較列表
  - 以表格形式並排展示所有方案
  - 提供方案移除功能
  - 允許直接從比較頁面添加方案到購物車
  - 提供清空比較列表功能

### 2. 贊助方案卡片比較按鈕

在每個贊助方案卡片中添加"添加到比較"按鈕，允許用戶輕鬆將方案添加到比較列表。

- **文件**: `src/components/events/SponsorshipPlanCard.tsx`
- **功能**:
  - 提供添加到比較的按鈕
  - 自動檢測方案是否已在比較列表中
  - 通過事件通知系統，確保 UI 狀態一致性

### 3. 底部比較面板

當用戶添加方案到比較列表後，在頁面底部顯示固定面板，顯示已選擇的方案數量並提供快速操作按鈕。

- **文件**: `src/components/comparison/ComparePanel.tsx`
- **功能**:
  - 顯示已選擇的方案數量
  - 提供"查看比較"按鈕，直接導航到比較頁面
  - 提供"清空比較"按鈕，快速清空比較列表
  - 自動監聽本地存儲變化，確保面板狀態與比較列表同步

## 數據存儲

比較功能使用本地存儲（localStorage）保存用戶選擇的方案，確保用戶在不同頁面間瀏覽時不會丟失已選擇的方案。

- **存儲鍵**: `plansToCompare`
- **存儲值**: 贊助方案對象陣列的 JSON 字符串

## 事件機制

為確保 UI 狀態與本地存儲的同步，我們實現了以下事件機制：

1. **storage 事件**: 當本地存儲值發生變化時通知相關組件
2. **compareUpdate 事件**: 自定義事件，用於通知比較面板和其他相關組件更新狀態

## 與購物車集成

比較功能與購物車功能緊密集成，用戶可以：

- 在比較頁面直接將方案添加到購物車
- 比較不同活動的贊助方案後再決定購買
- 使用"添加到購物車"按鈕，將比較頁面中的方案直接添加到購物車

## 使用流程

1. 用戶瀏覽活動頁面，查看各個贊助方案
2. 用戶點擊"添加到比較"按鈕，將方案添加到比較列表
3. 添加方案後，頁面底部會出現比較面板
4. 用戶可以繼續瀏覽其他活動並添加更多方案到比較列表
5. 通過比較面板點擊"查看比較"按鈕，導航到比較頁面
6. 在比較頁面，用戶可以並排比較各個方案的詳細信息
7. 用戶可以直接從比較頁面中添加方案到購物車
8. 用戶可以移除不需要的方案，或清空整個比較列表

## 技術實現

該功能使用 React Hooks 和本地存儲實現，主要技術點包括：

- **React 客戶端組件**: 所有相關組件都是客戶端組件（'use client'）
- **狀態管理**: 使用 React 的 useState 和 useEffect 管理本地狀態
- **存儲機制**: 使用 localStorage API 持久化比較列表
- **事件機制**: 使用 window 事件系統實現組件間的通信
- **UI 組件**: 基於現有的 UI 組件庫構建界面

## 未來擴展

未來可能的功能擴展包括：

1. **篩選和排序**: 允許用戶根據不同條件篩選和排序比較列表
2. **高亮差異**: 自動高亮不同方案之間的主要差異
3. **方案推薦**: 基於用戶偏好自動推薦最適合的方案
4. **社交分享**: 允許用戶分享比較結果給其他人
5. **數據同步**: 將比較列表同步到用戶帳戶，在不同設備間訪問 